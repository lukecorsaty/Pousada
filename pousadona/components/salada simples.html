<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#4b4d50">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://totvsfood.ninegrid.com.br/public/theme/material/center/assets/css/site.min.css">

    <link href="https://totvsfood.ninegrid.com.br/public/theme/material/global/css/bootstrap.css" rel="stylesheet">
    <link href="https://totvsfood.ninegrid.com.br/public/theme/material/global/css/bootstrap-extend.min.css" rel="stylesheet">


    <link rel="apple-touch-icon" sizes="180x180" href="https://s3.amazonaws.com/img.ninegrid.com/">
    <link rel="icon" type="image/png" sizes="32x32" href="https://s3.amazonaws.com/img.ninegrid.com/">
    <link rel="icon" type="image/png" sizes="16x16" href="https://s3.amazonaws.com/img.ninegrid.com/">

    <!-- Fonts -->
    <link rel="stylesheet" href="https://totvsfood.ninegrid.com.br/public/theme/material/global/fonts/material-design/material-design.min.css">
    <link rel="stylesheet" href="https://totvsfood.ninegrid.com.br/public/theme/material/global/fonts/brand-icons/brand-icons.min.css">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>

    <!-- jquery -->
    <script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/jquery/jquery.js"></script>

</head>
<style media="screen">
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');
body{
    padding-top:0;
    font-size: 16px;
    font-family: 'Poppins', sans-serif;
}
.page{
    background: #f5f5f5;
}
h5{
    font-size: 18px;
}
.header-embed {
    background: #4b4d50;
    flex-shrink: 0;
    padding: 12px;
    /* display: flex; */
    color: #fff;
    z-index: 100;
    width: 100%;
    height: 20px;
    text-align: center;
}
.app-color-default{
    background: #fff;
}
.img-default-app{
    background: url("") center top no-repeat;
    background-size: cover;
}
.test-header-app{
    /* background: #aaa; */
    height: 70px;
}
.top-app{
    background: #fff;
    height: 40px;
    width: 100%;
    margin: 0 auto;
    text-align: center;
    position: absolute;
}
.logo-app{
    /* border: 1px solid #eaeaea; */
    border-radius: 50px;
    margin: -6px auto 10px auto;
    width: 52%;
    padding: 10px;
    background: #fff;
    height: 78px;
    -webkit-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
    -moz-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
    box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
}
.name-app{
    float: left;
}
.logo-app img {
    /* width: 80%; */
    height: 100%;
}
.number_room{
    float: left;
}
.btn-back{
    cursor: pointer;
    float: left;
    /* background: #fff; */
    position: absolute;
    padding: 3px 12px;
    /* border-radius: 8px; */
    margin-top: -9px;
    font-size: 34px;
}
.serach-prod{
    float: right;
    width: 20px;
    cursor: pointer;
}
</style>
<script type="text/javascript">
$(document).ready(function(){
        $('.btn-back').on('click', function(){
        window.location = 'https://totvsfood.ninegrid.com.br/retail/rvc/DEQLY/MzA4Nw==';
    });
    });
</script>
<body>
    <div class="page">
        <div class="header-embed">
                            <div class="btn-back">
                    <i class="icon md-chevron-left" aria-hidden="true"></i>
                    <!-- <a class="" href="">
                        <i class="icon md-long-arrow-left" aria-hidden="true"></i> voltar
                    </a> -->
                </div>
                                        BAOBA            
            
            <div class="serach-prod">
                <svg version="1.1" id="menu_filter" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.005 512.005">
                            <path d="M505.749,475.587l-145.6-145.6c28.203-34.837,45.184-79.104,45.184-127.317c0-111.744-90.923-202.667-202.667-202.667
		                         	S0,90.925,0,202.669s90.923,202.667,202.667,202.667c48.213,0,92.48-16.981,127.317-45.184l145.6,145.6
		                         	c4.16,4.16,9.621,6.251,15.083,6.251s10.923-2.091,15.083-6.251C514.091,497.411,514.091,483.928,505.749,475.587z
		                          M202.667,362.669c-88.235,0-160-71.765-160-160s71.765-160,160-160s160,71.765,160,160S290.901,362.669,202.667,362.669z"></path>
                        </svg>
            </div>

        </div>
        <div class="test-header-app">
            <div class="top-app">
                <div class="name-app"></div>
                <div class="logo-app">
                                            <img src="https://s3.amazonaws.com/img.ninegrid.com/baoba/webapp/WhatsApp Image 2021-05-27 at 11.14.06.jpeg" alt="">
                                    </div>
            </div>
        </div>

<link rel="stylesheet" href="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/bootstrap-sweetalert/sweetalert.css">
<style media="screen">
body{
    font-size: 15px;
    line-height: 22px;
}
h5{
    font-size: 14px;
    margin-top: 0px;
    line-height: 0.5;
}
.link-product{
    text-align: center;
    cursor: pointer;
}
.btn-plus{
    float: right;
    color: #4B4D50;
}
.btn-minus{
    float: left;
    color: #4B4D50;
}
.buttons-amounts{
    float: left;
    font-size: 18px;
    background: #F5F5F5;
    border-radius: 3px;
    padding: 11px 0;
    height: 45px;
    width: 140px;
    text-align: center;
}
.buttons-amounts a{
    text-decoration: none;
}
#modal-product-add{
    height: 45px;
    float: right;
    background: #EA1D2C;
    border-color: #EA1D2C;
}
.btUpdateItemCart{
    font-size:20px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 0px;
}
.box-subcategory{
    background: #fff;
    white-space:nowrap;
    overflow-x:auto;
    border-bottom: 1px solid #eaeaea;
    margin-bottom: 10px;
    margin-top: 10px;
    /* margin: 10px auto;
    border-radius: 2px;
    -webkit-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
    -moz-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);
    box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1); */
}
.link-subcategory{
    cursor: pointer;
}
.card-subcategory{
    width: 120px;
    height: 122px;
    margin: 0px 5px;
    display:inline-block;
    text-align: center;
    color: #999;
}
.card-subcategory img{
    width: 120px;
    height: 14vh;
    object-fit: cover;
    border-radius: 6px;
    margin-bottom: 6px;
}
.card-subcategory-noimage{
    /* width: 120px; */
    height: 36px;
    margin: 5px 5px 15px 5px;
    display:inline-block;
    text-align: center;
    /* color: #1d1d1d; */
    border-bottom: 2px solid #999;
    /* border-radius: 10px; */
    padding: 2px 4px;
}
.box-product {
    border-bottom: 1px solid #eaeaea;
    margin: 0;
    padding: 12px 0;
    max-height: 170px;
    display: flow-root;
}
span.amount-modal {
    padding: 4px 10px;
    text-align: center;
}
h5#total-cart {
    width: 100%;
    margin-bottom: -6px;
    margin-top: 0;
}
.nav-tabs .nav-link>.icon{
    margin-right:3px;
}
.nav-tabs-line .nav-link{
    padding: .715rem 1.129rem;
}
.test-header-app{
    display: none;
}
.header-navmenu{
    top:36;
}
.header-embed {
    height: 46px;
    position: fixed;
    background: #f5f5f5;
    color: #000;
}
.border-status{
    padding-left: 10px;
    border-left: 5px solid;
}
.content-box{
    top:32px;
    position: relative;
    padding-bottom: 70px;
}
.product-title{
    font-weight: bold;
    text-align: left;
    line-height: 20px;
    color: #333;
}

.p-desc{
    float: left;
    width: 62%;
    font-size: 85%;
    line-height: 17px;
}
.p-desc-noimage{
    float: left;
    width: 100%;
    font-size: 95%;
    line-height: 16px;
}
.p-img img{
    border-radius: 8px;
    height: 100px;
    object-fit: cover;
}
.p-img{
    float: left;
    width: 30%;
    margin-left: 20px;
}
.p-price{
    display: inline-block;
    width: 100%;
    font-weight: bold;
}
.cart-blocked {
    background: #eaeaea;
    color: #333;
    font-size: 14px;
    padding-bottom: 0;
    text-align: center;
    margin-top: 46px;
    position: fixed;
    z-index: 10;
    width: 100%;
    padding-top: 14px;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, .1);
    cursor: pointer;
}
.cart-area{
    /* margin-top: 36px; */
    position: fixed;
    z-index: 10;
    width: 100%;
    background: #fff;
    padding: 10px;
    text-align: center;
    /* box-shadow: 1px 2px 4px rgba(0, 0, 0, .1); */
    box-shadow: 1px 2px 5px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    /* colocar carrinho na parte de baixo */
    bottom: 57px;
    background: #EA1D2C;
    color: #fff;
}
.cart-amount{
    float: left;
    padding-left: 6px;
}
.cart-value{
    float: right;
    font-size: 106%;
    font-weight: bold;
    padding-right: 10px;
}
.item-variation-name{
    float: left;
}
.item-variation-price{
    float: right;
    color: #5ba567;
}
.item-variation {
    display: flow-root;
    border: 1px solid #eaeaea;
    margin: 5px;
    border-radius: 8px;
    text-align: left;
    padding: 6px 8px;
    cursor: pointer;
}
.variation-selected{
    background: #e6e3e3;
}
.title-optional-list {
    font-weight: bold;
    margin: 10px;
    margin-top: 18px;
}
.optional-selected{
    border: 1px solid #0ba30b;
    color: #0ba30b;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, .2);
}
.buttons-op-amounts {
    float: right;
}
.btUpdateAmountOp{
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    margin: -4px 0;
}
.item-product-detail img{
    border-radius: 8px;
    /* height: 105px; */
    /* object-fit: cover; */
    width: auto;
    max-height: 280px;
    max-width: 270px !important;
}
.cart-desc-btn{
    text-align: center;
    border: 1px solid #eaeaea;
    background: #C91F29;
    color: #fff;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.1);
    padding: 10px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: bold;
}
.cart-desc-btn a{
    color: #fff;
}
/*  */
.input-ninegrid{
    border: 0;
    padding: 8px 0;
    width: 100%;
    border-radius: 8px;
    background-color: #F5F5F5;
    color: #000;
    padding: 10px 6px;
}
.title1{
    font-weight: bold;
    margin-top: 6px;
}
.modal-item-variation{
    font-size: 86%;
}
.notetext{
    background: #fff;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.1);
    padding-top: 20px;
}
</style>

<div class="nav-tabs-horizontal nav-tabs-inverse nav-tabs-animate" data-plugin="tabs">

    
    <div class="cart-blocked" id="cart-blocked" style="display:none">
        <p>A loja está fechada!</p>
    </div>

    <div class="tab-content content-box">
        <div class="tab-pane animation-fade active" id="box_products" role="tabpanel">
            <div class="page-content container-fluid box_products">
                <div class="row">

                    
                    
                    <div class="col-md-12">
                        <div class="box-subcategory">
                                                                                                            <input type="hidden" id="subcategory_id_init" name="subcategory_id_init" value="3526">
                                                                                    <div class="card-subcategory-noimage link-subcategory"
                            id="3526">
                                <p>Petiscos e entradas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3527">
                                <p>Saladas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3528">
                                <p>Pratos para 2 pessoas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3529">
                                <p>Pescados - pratos individuais</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3523">
                                <p>Carnes - pratos individuais</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3530">
                                <p>Sopa</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3522">
                                <p>Aves - pratos individuais</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3525">
                                <p>Massas e risotos - pratos individuais</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3531">
                                <p>Veganos - pratos individuais</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3524">
                                <p>Kids</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3532">
                                <p>Tapiocas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3533">
                                <p>Sanduíches</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3534">
                                <p>Sobremesas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3535">
                                <p>Paletas mexicanas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3536">
                                <p>Porções</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3537">
                                <p>Outros</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3538">
                                <p>Extra</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3539">
                                <p>Não alcoólicas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3540">
                                <p>Drinks</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3541">
                                <p>Cervejas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3542">
                                <p>Doses</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3543">
                                <p>Garrafas</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3544">
                                <p>Tintos secos</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3545">
                                <p>Brancos secos</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3546">
                                <p>Tintos suaves</p>
                            </div>
                                                                                                                                        <div class="card-subcategory-noimage link-subcategory"
                            id="3547">
                                <p>Espumantes</p>
                            </div>
                                                                            </div>

                    </div>
                </div>
                <div class="row" id="menu-products"></div>
            </div>
        </div>

        <div class="tab-pane animation-fade" id="bot_cart" role="tabpanel">
            <div class="page-content container-fluid box_products">
                <div class="row" style="padding:0 10px; border-bottom:1px dashed #ccc">
                    <h5 id="total-cart-old"></h5>
                    <h5 style="color:#CE433C">&nbsp;</h5>
                    <div class="btn-finish">
                        <a href="javascript:void(0)" id="btn-send-order"
                        class="btn btn-primary btn-sm">
                            <i class="icon md-mail-send" aria-hidden="true"></i> Enviar pedido
                        </a>
                    </div>
                </div>
                <div class="" id="box-menu-cart"></div>
            </div>
        </div>
    </div>
</div>
<style media="screen">
.btn-color1{
    background: #AFC7D4;
    color: #fff;
}
.btn-color2{
    background: #4B4D50;
    color: #fff;
}
.footer-pdv{
    height: 58px;
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #fff;
    border-top: 1px solid #eaeaea;

    display:         flex;
    flex-wrap:       wrap;
    justify-content: center;
}
.footer-item {
    width: 20%;
    /* background: #ccc; */
    text-align: center;
    float: left;
    height: 50px;
    margin: 5px 2px;
    font-size: 80%;
    padding-top: 6px;
    cursor: pointer;
}
.order-item-list {
    border: 1px solid #eaeaea;
    margin: 10px 0;
    padding: 10px;
    border-radius: 12px;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, .1);
}
.hour_operation {
    font-weight: bold;
    margin: 8px 0;
    font-size: 12px;
    border-bottom: 1px solid #eaeaea;
    padding-bottom: 8px;
}
.date-order{
    margin-bottom: 8px;
}
.cart-title{
    text-align: center;
    font-size: 14px;
    border-bottom: 1px solid #eaeaea;
    margin-bottom: 10px;
    padding-bottom: 10px;
    display: flow-root;
}
.btn-search{
    background: #6ac798;
    color: #fff;
    width: 100%;
    margin-top: 20px;
}
.btn-search:hover{
    background: #6ac798;
    border: 1px solid #fff;
}
</style>

<div class="footer-pdv">
    <div class="footer-item" id="pdv">
        <img src="https://totvsfood.ninegrid.com.br/public/default/images/icons/home.png" width="24px" alt="">
        <br> Inicio
    </div>
    <div class="footer-item" id="information">
        <img src="https://totvsfood.ninegrid.com.br/public/default/images/icons/informacao.png" width="24px" alt="">
        <br> Info
    </div>

            <div class="footer-item" id="my-orders">
            <img src="https://totvsfood.ninegrid.com.br/public/default/images/icons/pedidos.png" width="24px" alt="">
            <br> Pedidos
        </div>
        <!-- <div class="footer-item">
        <img src="public/default/images/icons/compras.png" width="24px" alt="">
        <br> Carrinho
    </div> -->
</div>

<!-- modal delivey address -->
<div class="modal fade" id="md-info" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <p><p style="text-align: center;"><a href="https://wa.me/qr/2KMYLGLT3RBYM1">Pe&ccedil;a pelo WhatsApp (81)98138-5865</a></p>
<p style="text-align: center;">Cobramos taxa de servi&ccedil;o 10% (opcional)</p></p>
                <p>Horários de funcionamento:</p>
                <div class="hour_operation">Domingo das 09:00 até 21:30</div><div class="hour_operation">Segunda das 09:00 até 21:30</div><div class="hour_operation">Terça das 09:00 até 21:30</div><div class="hour_operation">Quarta das 09:00 até 21:30</div><div class="hour_operation">Quinta das 09:00 até 21:30</div><div class="hour_operation">Sexta das 09:00 até 21:30</div><div class="hour_operation">Sábado das 09:00 até 21:30</div>            </div>
        </div>
    </div>
</div>

<!-- modal my orders -->
<div class="modal fade" id="md-my-orders" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" style="text-align:center">
                    Meus pedidos
                </h4>
            </div>
            <div class="modal-body">
                <div id="list-myorders"></div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="md-search-product" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <div class="cart-title">
                    <h4> Procurar produto</h4>
                </div>

                <input type="text" name="search-product-name" id="search-product-name" class="form-control "
                       placeholder="Nome do produto">
                <input id="btn-search-product-name" name="btn-search-product-name"
                       class="btn btn-primary cart-desc-btn btn-search"
                       type="button" value="Procurar" data-dismiss="modal">
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="md-content-note" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="mdh-body" style="padding:0"></div>
        </div>
    </div>
</div>

<!-- modal my orders -->
<div class="modal fade" id="md-finish" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body" style="text-align:center">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <img src="https://totvsfood.ninegrid.com.br/public/default/images/garcom.jpg" width="150px" alt="">
                                <h3 align="center">Para finalizar a conta<br> chame o garçom!</h3>
                

                <!-- <h3 align="center">Ou</h3> -->

            </div>
        </div>
    </div>
</div>

<!-- modal my orders -->
<div class="modal fade" id="md-my-preconta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" style="text-align:center">
                    
                    Meus pedidos <small> 26/09/2024 01:03:40</small>
                </h4>
            </div>
            <div class="modal-body">
                <div id="list-preconta"></div>
                <div id="list-preconta-totais"></div>
            </div>
        </div>
    </div>
</div>

<!-- modal fechar pedido -->
<style media="screen">
.btsearch{
    text-align: center;
    border: 1px solid #eaeaea;
    background: #AFC7D4;
    color: #fff;
    box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.1);
    padding: 10px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: bold;
}
.btsearch a{
    color: #fff;
}
.total-preconta{
    border-top: 1px dashed #999;
    text-align: right;
    padding: 15px 0;
    display: inline-block;
    width: 100%;
    float: right;
    margin-top: 5px;
}
.item-preconta {
    display: flow-root;
}
.item-preconta-info {
    float: left;
    width: 12%;
}
.item-preconta-name {
    float: left;
    width: 54%;
}
.item-preconta-price {
    float: right;
}
/* input-ninegrid */
#list-myorders input{
    border: 0;
    padding: 8px 0;
    width: 100%;
    border-radius: 8px;
    background-color: #F5F5F5;
    color: #000;
    padding: 10px 6px;
}
#mdh-body img{
    width: 100%;
}
</style>
<script src="https://totvsfood.ninegrid.com.br/public/default/js/jquery.maskedinput-1.3.js" type="text/javascript"></script>
<script type="text/javascript">
var URL = 'https://totvsfood.ninegrid.com.br/';
var route_hash = 'DEQLY';
var route_location_id = 'MzE1Mw==';
var online_payment = false;
$(document).ready(function(){
        $('#pdv').on('click', function(){
        window.location = URL + 'retail/pdv/' + route_hash + '/' + route_location_id + '/';
    });
        $( '#information' ).on('click', function(){
        $('#md-info').modal('show');
    });

    $( '#finish' ).on('click', function(){
        $('#md-finish').modal('show');
    });

    $('#my-orders').on('click', function(){
        // $('#md-my-orders').modal('show');
        window.location = URL + 'retail/myorders/' + route_hash + '/' + route_location_id;
    });

    
    var pluginconfig_id = '';

    //fechar mesa =================
    $('#btn-fecharmesa').on('click', function(){
        if (online_payment == true) {
            window.location = URL + 'retail/closetable/' + route_hash + '/' + route_location_id + '/';
        }
        /*
        $.post(URL + 'totvsmesa/closeTable//' + pluginconfig_id,
            function(data){
                console.log(data);
                window.location = URL + 'retail/closetable/' + route_hash + '/' + route_location_id + '/';
            },'json');
        */
    });

    $('#my-preconta').on('click', function(){
        $('#md-my-preconta').modal('show');
        var html = '';
        //$('#list-preconta').html(html);

        $.post(URL + 'totvsmesa/getTableMovement//' + pluginconfig_id,
            function(data){
                console.log("==> " + JSON.stringify(data, null, 4));
                for(var i in data)
                {
                    var item = data[i];
                    console.log(item);

                    html += '<div class="item-preconta">';
                    html += '<div class="item-preconta-info">'+item.code+'</div>';
                    html += '<div class="item-preconta-name">' +item.name+ '</div>';
                    html += '<div class="item-preconta-info">';
                    html += item.quantity + 'x ';
                    html += '</div>';
                    html += '<div class="item-preconta-price">';
                    let precoVenda = item.price.toLocaleString('pt-br', {minimumFractionDigits: 2});
                    html += 'R$ ' + precoVenda
                    html += '</div>';
                    html += '</div>';
                }

                // var totais = data.ConsultarMovimentacaoMesaResult.Totais;
                //
                // html += '<div class="total-preconta">';
                // html += '<div class="itens-totais">Subtotal R$ '+ totais.Subtotal.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                // html += '<div class="itens-totais">Desconto R$ '+ totais.Desconto.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                // html += '<div class="itens-totais">Serviço R$ '+ totais.Servico.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                // html += '<div class="itens-totais">Total R$ '+ totais.TotalConta.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div>';
                // html += '</div>';

                console.log(html);
                $('#list-preconta').html(html);

            },'json');


        var html_totais = '';
        $.post(URL + 'totvsmesa/ConsultarMovimentacaoMesa//'+pluginconfig_id,
            function(data){
                console.log(data);
                if( data.ConsultarMovimentacaoMesaResult.Erros == null )
                {
                    var items = data.ConsultarMovimentacaoMesaResult.Itens;
                    var totais = data.ConsultarMovimentacaoMesaResult.Totais;

                    html_totais += '<div class="total-preconta">';
                    html_totais += '<div class="itens-totais">Subtotal R$ '+ totais.Subtotal.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                    //html_totais += '<div class="itens-totais">Desconto R$ '+ totais.Desconto.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                    html_totais += '<div class="itens-totais">Serviço R$ '+ totais.Servico.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div><hr>';
                    html_totais += '<div class="itens-totais">Total R$ '+ totais.TotalConta.toLocaleString('pt-br', {minimumFractionDigits: 2}); +'</div>';
                    html_totais += '</div>';

                    $('#list-preconta-totais').html(html_totais);
                }
            },'json');

    });


    
    // save data customer contact
    // ========================================================================
    $('#list-myorders').on('click', '#btn-search-orders', function(){
        $.post(URL+'customer/setSessionContact',{
            email: $('#customerEmail').val(),
            phone: $('#customerPhone').val()
        }, function(data){
            loadOrdersBySenderEmail();
        },'json');
    });

    //loadOrdersBySenderEmail();

    $(document).on('click', '#mdh', function(){
        $('#md-content-note').modal('show');
        let linkint = $(this).attr('title');
        let linkimg = '<img src=' + linkint + '>';
        $('#mdh-body').html(linkimg);
    });
});

function loadOrdersBySenderEmail()
{
    $.post(URL + 'order/listOrdersBySenderEmail',
        function( data ){
            console.log( data );
            var html = '';
            if( data.length > 0 )
            {
                for( var i in data )
                {
                    var order = data[i];
                    html += '<div class="order-item-list">';
                    html += '<div class="date-order">' +  order.created + '</div>';
                    html += '<h5>' + order.location + '</h5>';
                    html += 'Pedido: ' + order.id +  ' ( '+order.status_name+' )';
                    var colorText = '#999';
                    for(var p in order.products)
                    {
                        var product = order.products[p];
                        colorText = colorText == '#000' ? '#999' : '#000';
                        html += '<div style="color:'+ colorText  +'">';
                        html += '<small>'+ product.quantity +'x '+ product.product.name +'</small><br>'; // '+ item.product.name +'
                        html += '</div>';
                    }
                    html += '</div>';
                }
            }
            else
            {
                html += '<h4>Não encontramos nenhum pedido.</h4>';
                html += '<h5>Vamos procurar. </h5><h5>Por favor, entre com seu e-mail e telefone.</h5>';
                html += '<div class="form-group">';
                html += '<input type="text" class="form-control data_customer"';
                html += 'placeholder="E-mail" name="email" id="customerEmail" value="">';
                html += '</div>';
                html += '<input type="text" class="form-control data_customer mask-phone"';
                html += ' placeholder="Telefone" name="telefone" id="customerPhone" value="" inputmode="numeric">';
                html += '</div>';
                html += '<div class="btsearch" style="text-align:center; margin-top:15px">';
                html += '    <a href="javascript:void(0)" id="btn-search-orders" >';
                html += '        <i class="icon md-search" aria-hidden="true"></i>';
                html += '        Procurar';
                html += '    </a>';
                html += '</div>';
            }
            $('#list-myorders').html(html);
            $('.mask-phone').mask('(99) 9999-9999?9');
    }, "json");
}
</script>
<!-- modal product-detail -->
<div class="modal fade" id="product-detail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="modal-product-label" style="text-align:center"></h4>
            </div>
            <input type="hidden" name="modal-variation-id" id="modal-variation-id" value="">
            <input type="hidden" name="modal-variation-amount" id="modal-variation-amount" value="1">
            <input type="hidden" name="modal_optional[]" id="modal-optional-id" value="">
            <div class="modal-body" id="modal-product-body"></div>
            <div class="modal-footer" id="modal-product-footer"></div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="mdRequestInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" style="text-align:center">Por favor digite o número da mesa:</h5>
                <div class="form-group form-material floating" data-plugin="formMaterial">
					<input
                    type="text"
                    name="account"
                    id="account"
                    style="text-align:center"
                    class="form-control"
                    required="required"
                    placeholder="Número"
                    value="" />
				</div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="requestName">Enviar</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal preconta -->
<div class="modal fade" id="preconta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" style="text-align:center">Meus pedidos</h4>
            </div>
            <div class="modal-body" id="modal-preconta">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
            </div>

        </div>
    </div>
</div>


<script type="text/javascript">
// URL
// ============================================================================
var URL = 'https://totvsfood.ninegrid.com.br/';

// configs
// ============================================================================
var config = {
    'pluginspace_id': '290',
    'ext_location_id':'3087',
    'account': 'DEQLY',
    'int_location_id':'3153',
    'int_location_code': 'withdraw',
}

// vars
// ============================================================================
var terms = 0;
var nameCustomer = '';
var amount = 1;
var optional = new Array();
var pdvconfig = new Array();
var variation_id = '';
var variation_price = '00,00';
var open_price = 0;
var valueTotal = {};
var pdvconfig = JSON.parse('{"status":1,"integration_active":0,"pluginconfig_id":"","order":1,"settings":{"requestToken":0,"requestPayment":0,"requestName":0,"useQR":0,"useComments":1,"accountSummary":0},"layout":{"useImage":1,"useImageCategory":0,"colorButton":"#333","colorButtonBorder":"#333","colorText":"#333","colorTitle":"#333"},"gateway_active":0,"gateway_config":"","translation":0}');
var radioOptional = {};
var optionalsRequired = {};
var alreadyOpen = '';
var randomtoken = 0;
var type = "qr";
var useComments = 1;
var typetext = 'ucfirst';
var $coin = 'R$';
var product_price = 0;


console.log(alreadyOpen);

function getCurrentDate( hour = 0 ){
    var dNow = new Date();
    var localdate = dNow.getFullYear() +'-'+(dNow.getMonth()+1)+'-'+dNow.getDate();
    var localhour = dNow.getHours() + ':' + dNow.getMinutes();
    if( hour != 0 )
    {
        return localdate + ' ' + localhour;
    }
    else
    {
        return localdate;
    }
}

function blockCart()
{
    $('#cart-blocked').css('display', '');
    $('#cart-area').css('display', 'none');
}

$(document).ready(function(){

    var weekday = new Date().getDay();
    $.get(URL+'location/getLocationOperation/' + config.ext_location_id +'/'+weekday, function(data){
        if( data.length == 0 )
        {
            // bloqueia carrinho
            blockCart();
        }
        else
        {
            const currentTime = new Date( getCurrentDate(1) );
            const time_start_1 = new Date(getCurrentDate() +' '+ data.time_start_1);
            const time_end_1 = new Date(getCurrentDate() +' '+ data.time_end_1);

            // link cart
            $('#cart-area').on('click', function(){
                window.location = URL + 'retail/confirm/DEQLY/MzE1Mw==/';
            });

            if (currentTime.getTime() < time_start_1.getTime() ) {
            	// fora do horario bloqueia carrinho
                blockCart();
            }

            if( data.time_start_2 != '00:00:00' )
            {
                const time_start_2 = new Date(getCurrentDate() +' '+ data.time_start_2);
                const time_end_2 = new Date(getCurrentDate() +' '+ data.time_end_2);

                if (currentTime.getTime() > time_end_1.getTime() && currentTime.getTime() < time_start_2.getTime() ) {
                	// fora do horario bloqueia carrinho
                    blockCart();
                }

                if (currentTime.getTime() > time_end_2.getTime())
                {
                    blockCart();
                }
            }
            else
            {
                if( currentTime.getTime() > time_end_1.getTime() )
                {
                    blockCart();
                }
            }
        }
    },"json");

    // PDV
    // =====================================================================
    var subcategory_id_init = $('#subcategory_id_init').val();
    listProducts(subcategory_id_init);

    var target1 = "#"+subcategory_id_init;
    setLinkSelected($(target1));

    setProductsOfCart(config.int_location_id);
    sumTotalCart(config.int_location_id);

    $('.link-subcategory').on('click', function(){
        setLinkSelected($(this));
        subcategory_id = $(this).attr('id');
        listProducts(subcategory_id);
    });

    // search product
    // ========================================================================
    $('#menu_filter').on('click', function () {
        $('#search-product-name').focus();
        $('#md-search-product').modal('show');
        $('#btn-search-product-name').css('display','');
    });

    $('#btn-search-product-name').on('click', function () {
        let product_name = $('#search-product-name').val();
        listProducts('', product_name);
        $('#search-product-name').val("");
    });

    // get product
    // ========================================================================
    $('#box_products').on('click', '.link-product', function(){
        // amount_total = 0;
        valueTotal = {};
        for (var key in radioOptional) {
            delete radioOptional[key];
        }

        /**
         * verifica se e um produto fracionado para colocar o
         * valor do produto dentro do objeto para fazer a somatoria
         * com os adicionais
         */
        let productFractionated = $(this).data('fractionated');

        if( productFractionated == null ){
            let productPrice = parseFloat(replaceString($(this).data('price'))).toFixed(2);
            valueTotal[$(this).attr('id')] = Number(productPrice);
        }

        var product_id = btoa($(this).attr('id'));
        // internal_id: config.int_location_id,
        $('#modal-product-body').html('');
        setLoading('#modal-product-body');
        optional = new Array();
        // console.log(product_id);
        $.post(URL+'product/getProduct/'+product_id +'/' + typetext, {
            location_id: config.int_location_id
        }, function(data){
            // console.log(data);
            var product = data;
            var variations = product.variations;
            console.log(product);
            var html = '<div class="item-product-detail" style="text-align:center; margin:-15px 0 10px 0">';

    		if( pdvconfig.layout.useImage )
    		{
    			html += '<img width="50%" ';
    			html += 'style="border:1px solid #ccc; padding: 4px; border-radius:8px"';
    			html += 'src="'+product.img+'" alt="'+product.name+'">';
    		}

            html += '<p class="title1">' + product.name + '</p>';
    		html += '<p style="text-align:center">';
    		html += product.description;
    		html += '</p>';

    		html += '</div>';

            variation_id = variations[0].id;
            variation_price = variations[0].price;
            open_price = parseFloat(replaceString(variation_price)).toFixed(2);
            open_price = Number(open_price);
            product_price = open_price;

            // variations
            // ================================================================
            if( variations.length > 1 )
            {
                html += '<div class="modal-item-variation">';
                var variation_first = 1;
                for( var i in variations )
                {
                    var variation = variations[i];
                    var css_class = variation_first ? 'variation-selected' : '';
                    variation_first = 0;
                    html += '<div class="item-variation '+ css_class +'">';
                    html += '<div class="item-variation-name">' + variation.name + '</div>';
                    html += '<div class="item-variation-price"><span class="price">'+$coin+' ' + variation.price + '</span></div>';
                    html += '</div>';
                }
                html += '</div>';
            }
            optionalsRequired = {};
            amountTotal = {};
            // console.log(product);
            // optionals
            // ================================================================
            var totalOptionals = product.optionals.length;
            if( totalOptionals > 0 )
            {
                html += '<div class="modal-item-variation">';
                for( var o in product.optionals )
                {
                    var listOptional = product.optionals[o];

                    html += '<div class="title-optional-list">' + listOptional.name;
                    if( listOptional.required == 1 )
                    {
                        html += ' <small>( Obrigatório ) </small> ';
                    }

                    if( listOptional.max > 0 )
                    {
                        html += ' <small>Máximo '+ listOptional.max +'</small> ';
                    }

                    html += '</div>';
                    html += '<div data-required="'+listOptional.required+'" ' ;
                    html += ' data-itemcombo="'+listOptional.itemcombo_id+'" id="'+listOptional.id+'"';
                    html += '>';

                    // set optionalsRequired
                    optionalsRequired[listOptional.id] = {
                        'required': parseInt(listOptional.required),
                        'selected': false
                    };

                    amountTotal[listOptional.id] = 0;

                    // verify type list optional
                    if( listOptional.type == 'amount' )
                    {
                        // type amount
                        for( var op in listOptional.items )
                        {
                            var optional = listOptional.items[op];
                            html += '<div class="item-variation amount-optional" id="' + optional.id + '">';
                            html += '<div class="item-variation-name">' + optional.name;
                            html += '<br><small>'+optional.description+'</small>';
                            html += '</div>';

                            // buttons amounts
                            // ================================================
                            var item_price = optional.price == undefined ? null : optional.price;
                        	html += '<div class="buttons-op-amounts" data-price="'+item_price+'">';
                			html += '<div data-opquantity="plus" data-opid="'+optional.id+'" data-max="'+listOptional.max+'" class="btUpdateAmountOp btn-plus">&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;</div>';
                			html += '<span class="amount-op-modal" id="'+optional.id+'">0</span>';
                			html += '<div data-opquantity="minus" data-opid="'+optional.id+'" class="btUpdateAmountOp btn-minus">&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;</div>';
                			html += '</div>';

                            if( optional.price != null && optional.price != '0,00' && optional.fractionated == false )
                            {
                                html += '<div class="item-variation-price">';
                                html += '<span class="price">'+$coin+' ' + optional.price + '</span>';
                                html += '</div>';
                            }
                            html += '</div>';
                        }
                    }
                    else if( listOptional.type == 'checkbox' )
                    {
                        // type checkbox
                        for( var op in listOptional.items )
                        {
                            var optional = listOptional.items[op];
                            var item_price = optional.price == undefined ? null : optional.price;
                            html += '<div class="item-variation checkbox-optional" data-max="'+listOptional.max+'" data-price="'+item_price+'" id="' + optional.id + '">';
                            html += '<div class="item-variation-name">' + optional.name;
                            html += '<br><small>'+optional.description+'</small>';
                            html += '</div>';

                            if( optional.price != null && optional.price != '0,00' && optional.fractionated == false )
                            {
                                html += '<div class="item-variation-price">';
                                html += '<span class="price">'+$coin+' ' + optional.price + '</span>';
                                html += '</div>';
                            }
                            html += '</div>';
                        }
                    }
                    else
                    {
                        // type radio
                        for( var op in listOptional.items )
                        {
                            var dataCount = listOptional.length;
                            var optional = listOptional.items[op];
                            var item_price = optional.price == undefined ? null : optional.price;
                            html += '<div class="item-variation radio-optional ';
                            html += 'rd-'+listOptional.id+'" '
                            html += 'data-listOptionalid="'+listOptional.id+'" ';
                            html += 'data-fractionated="'+optional.fractionated+'" ';
                            html += 'data-count="'+totalOptionals+'" ';
                            html += 'data-totalFractionated="'+product.totalFractionated+'" ';
                            html += 'data-price="'+item_price+'" ';
                            html += 'id="' + optional.id + '">';
                            html += '<div class="item-variation-name">' + optional.name;
                            html += '<br><small>'+optional.description+'</small>';
                            html += '</div>';

                            if( optional.price != null && optional.price != '0,00' && optional.fractionated == false )
                            {
                                html += '<div class="item-variation-price">';
                                html += '<span class="price">+ '+$coin+' ' + optional.price + '</span>';
                                html += '</div>';
                            }
                            html += '</div>';
                        }
                    }
                    html += '</div>';
                }
                html += '</div>';
            }

            if( terms )
            {
        		html += '<div class="row" style="padding:15px">';
                if( useComments ){
                    html += '<p>Observações</p>';
                    html += '<textarea class="form-control input-ninegrid" maxlength="50" id="info" name="info" rows="2"></textarea>';
                }
        		html += '</div>';

                // buttons amounts
                // ================================================================
            	html += '<div class="buttons-amounts">';
    			html += '<div title="plus" id="'+variation_id+'" class="btUpdateItemCart btn-plus">&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;</div>';
    			html += '<span class="amount-modal">1</span>';
    			html += '<div title="minus" id="'+variation_id+'" class="btUpdateItemCart btn-minus">&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;</div>';
    			html += '</div>';

                // buttons add and price
                // ================================================================
                html += '<button type="button" class="btn btn-primary" id="modal-product-add">';
                if( variation_price == '' )
                {
                    variation_price = '0,00';
                }

                if( product.fractionated != null )
                {
                    variation_price = '0,00';
                }

                html += 'Adicionar '+$coin+' <span id="variation-price">' + variation_price + '</span>';
                html += '</button>';
            }

            $('#modal-product-body').html(html);

        },"json");

        $('#product-detail').modal('show');
    });

    // buttons amount
    // ========================================================================
    // botao quantidade dos opcionais
    // var amount_total = 0;
    $('#modal-product-body').on('click', '.btUpdateAmountOp',function(){
        var op = $(this).data('opquantity');
        var opid = $(this).data('opid');
        var targetOp = '#' + opid;
        var item = $(this).closest('.buttons-op-amounts').find(targetOp);
        var amount = parseInt($(item).html());
        var itemParent = $(this).closest('.amount-optional');
        var index = -1;
        var max = $(this).data('max');
        var parent_id = itemParent.parent().attr('id');

        optional_price = '';
        if( $(this).parent().data('price') != null && $(this).parent().data('price') != undefined )
        {
            var optional_price = $(this).parent().data('price');
        }
        optional_price = parseFloat(replaceString(optional_price)).toFixed(2);

        // get index obj clicked
        for(var i=0; i<optional.length; i++) {
            if( optional[i].id === opid ) {
                index = i;
            }
        }

        price_sum = 0;

        if( op == 'plus' )
        {
            if( max == null || amountTotal[parent_id] < max || max == 0 )
            {
                amount++;
                amountTotal[parent_id]++;
                $(item).html( amount );
                $(itemParent).addClass('optional-selected');
                price_sum = Number(open_price) + Number(optional_price);
            }
        }
        else
        {
            if( amount >= 1 )
            {
                amount--;
                amountTotal[parent_id]--;
                price_sum = Number(open_price) - Number(optional_price);
            }
            if( amount == 0 )
            {
                $(itemParent).removeClass('optional-selected');
            }

            $(item).html( amount );
        }

        console.log(amountTotal);

        if(price_sum > 0)
        {
            open_price = price_sum;
            variation_price_final = price_sum.toLocaleString('pt-BR', { minimumFractionDigits: 2});
            //$('#variation-price').html( variation_price_final );
        }

        var objOpAmount = {
            'type': 'amount',
            'id' : opid,
            'value': optional_price,
            'quantity': amount,
            'itemCombo_id': ''
        }

        // console.log(objOpAmount);

        if( index > -1 )
        {
            optional.splice(index, 1);
        }

        if( amount > 0)
        {
            optional.push(objOpAmount);
        }

        let price_final = calcValueAdditionals(optional, product_price);
        $('#variation-price').html( price_final );

        // adicionar verificacao de obrigatoriedade
        var dataRequired = itemParent.parent().data('required');
        // console.log(parent_id);
        // console.log(dataRequired);
        optionalsRequired[parent_id] = {
            'required': dataRequired,
            'selected': false
        };

        if( optional.length > 0 )
        {
            optionalsRequired[parent_id] = {
                'required': dataRequired,
                'selected': true
            };
        }

    });

    // buttons amount
    // ========================================================================
    $('#modal-product-body').on('click', '.btUpdateItemCart',function(){
        var op = $(this).attr('title');
        var variation_id = $(this).attr('id');
        var item = '.amount-modal';
        var amount = parseInt($(item).html());

        if( op == 'plus' )
        {
            amount++;
            $(item).html( amount );
        }
        else
        {
            if(amount>1)
            {
                amount--;
            }
            $(item).html( amount );
        }

        $('#modal-variation-amount').val(amount);

        // console.log(amount);
        // console.log(open_price);

        if( !isNaN( open_price ) )
        {
            var price_calculated = ( open_price * amount );
            variation_price_final = price_calculated.toLocaleString('pt-BR', { minimumFractionDigits: 2});
            //$('#variation-price').html( variation_price_final );

            //console.log(amount);
            let price_final = calcValueAdditionals(optional, product_price, amount);
            $('#variation-price').html( price_final );
        }
    });

    // optional checkbox
    // ========================================================================
    $('#modal-product-body').on('click', '.checkbox-optional',function(){
        var optional_id = $(this).attr('id');
        var objOpCheckbox = {};
        var index = -1;
        var itemCombo_id = $(this).parent().data('itemcombo');
        var optional_price = $(this).data('price');
        var max = $(this).data('max');
        // get index obj clicked
        for(var i=0; i<optional.length; i++) {
            if( optional[i].id === optional_id && optional[i].type == 'checkbox' ) {
                index = i;
            }
        }

        var item = '.amount-modal';
        $(item).html(1);

        // console.log( 'length: ' + optional.length );
        // console.log( 'max:' + max );

        if ( index == -1 )
        {
            if( optional.length < max || max == 0 )
            {
                objOpCheckbox = {
                    'type': 'checkbox',
                    'id' : optional_id,
                    'value': parseFloat(optional_price),
                    'quantity': 1,
                    'itemCombo_id': itemCombo_id
                };
                optional.push(objOpCheckbox);
                $(this).addClass('optional-selected');

                // sum value
                // ================================================================
                if( optional_price != null )
                {
                    optional_price = parseFloat(replaceString(optional_price)).toFixed(2);
                    price_sum = Number(open_price) + Number(optional_price);

                    open_price = price_sum;
                    variation_price_final = price_sum.toLocaleString('pt-BR', { minimumFractionDigits: 2});
                    //$('#variation-price').html( variation_price_final );
                }
            }
        }
        else
        {
            optional.splice(index, 1);
            $(this).removeClass('optional-selected');

            // subtract value
            // ================================================================
            if( optional_price != null )
            {
                optional_price = parseFloat(replaceString(optional_price)).toFixed(2);
                price_sum = Number(open_price) - Number(optional_price);

                open_price = price_sum;
                variation_price_final = price_sum.toLocaleString('pt-BR', { minimumFractionDigits: 2});
                //$('#variation-price').html( variation_price_final );
            }

        }

        let price_final = calcValueAdditionals(optional, product_price);
        $('#variation-price').html( price_final );

        var parent_id = $(this).parent().attr('id');
        var dataRequired = $(this).parent().data('required');
        optionalsRequired[parent_id] = {
            'required': dataRequired,
            'selected': false
        };

        if( optional.length > 0 )
        {
            optionalsRequired[parent_id] = {
                'required': dataRequired,
                'selected': true
            };
        }
    });

    // optional radio
    // ========================================================================
    $('#modal-product-body').on('click', '.radio-optional', function(){
        var optional_id = $(this).attr('id');
        var parent_id = $(this).parent().attr('id');
        var itemCombo_id = $(this).parent().data('itemcombo');
        var totalFractionated = $(this).data('totalfractionated');
        var item_fractionated = $(this).data('fractionated');

        for(var i=0; i<optional.length; i++) {
            if( optional[i].type == 'radio' ){
                optional.splice(i, 1);
            }
        }

        if( $(this).data('price') != null && $(this).data('price') != undefined )
        {
            optional_price = $(this).data('price');
            optional_price = parseFloat(replaceString(optional_price)).toFixed(2);
            if( $(this).data('fractionated') == true )
            {
                optional_price = (optional_price / $(this).data('totalfractionated')).toFixed(2);
                open_price = 0;
            }
            valueTotal[parent_id] = Number(optional_price);
        }
        $('.rd-' + parent_id).removeClass('optional-selected');
        $(this).addClass('optional-selected');

        var objOpRadio = {
            'type': 'radio',
            'combo_id' : parent_id,
            'id' : optional_id,
            'value': parseFloat(optional_price),
            'quantity': 1,
            'itemCombo_id': itemCombo_id,
            'item_fractionated': item_fractionated
        };
        // console.log(objOpRadio);
        // update value into button
        optional.push(objOpRadio);
        price_sum = Number(open_price) + Number(optional_price);

        console.log(optional);
        variation_price_final = price_sum.toLocaleString('pt-BR', { minimumFractionDigits: 2});
        //if( item_fractionated == true ){
        var totalFractionated = 0;
        for( var i in valueTotal )
        {
            totalFractionated += valueTotal[i];
        }
        open_price = totalFractionated;

        variation_price_final = totalFractionated.toLocaleString('pt-BR', { minimumFractionDigits: 2});
        //}
        // console.log(price_final);
        let price_final = calcValueAdditionals(optional, product_price);
        $('#variation-price').html( price_final );
        radioOptional[parent_id] = objOpRadio;

        // object optionalsRequired
        var dataRequired = $(this).parent().data('required');
        optionalsRequired[parent_id] = {
            'required': dataRequired,
            'selected': true
        };
    });

    $('#box-menu-cart').on('click', '.btnSub', function(){
        let hash = $(this).attr('title');
        let quantity_current = $('#amount_' + hash).html();

        if( quantity_current > 1 )
        {
            quantity_current--;
            $.post( URL + "product/updateProductToCart", {
                hash: hash,
                op: 'minus'
            }, function( data ){
                sumTotalCart(config.int_location_id);
                $('#amount_' + hash).html(quantity_current);
            }, "json");
        }
    });

    $('#box-menu-cart').on('click', '.btnAdd', function(){
        let hash = $(this).attr('title');
        let quantity_current = $('#amount_' + hash).html();
        quantity_current++;
        $.post( URL + "product/updateProductToCart", {
            hash: hash,
            op: 'plus'
        }, function( data ){
            sumTotalCart(config.int_location_id);
            // $('#amount_' + variation_id).html(data[0].quantity);
            $('#amount_' + hash).html(quantity_current);
        }, "json");
    });

    // Add product to cart
    $('#modal-product-body').on('click', '#modal-product-add', function(){
        var amount = $('#modal-variation-amount').val();
        var info = $('#info').val();
        var idElements = new Array();
        Object.entries(optionalsRequired).forEach(([key, value]) => {
            var idElement = key;
            var required = value.required;
            var selected = value.selected;
            if( required == 1 && selected == false )
            {
                idElements.push(key);
                var targetElement = '#'+key;
                $(targetElement).prev().css('color', '#C91F29');
            }
        });

        if( idElements.length == 0 )
        {
            // for(var i in radioOptional)
            // {
            //     var optional_id = radioOptional[i];
            //     optional.push(optional_id);
            // }
            console.log('optional');
            console.log(optional);
            $.post( URL + "product/addProductToCart_v2", {
                variation_id: variation_id,
                optional: optional,
                amount: amount,
                info: info,
                internal_id: 3153            }, function( data ) {
                setProductsOfCart(config.int_location_id);
                sumTotalCart(config.int_location_id);
                $('#modal-variation-amount').val(1);
            }, "json");

            $('#product-detail').modal('hide');
        }
    });

    // Remove product to cart
    $('#box-menu-cart').on('click', '.product-remove',function(){
        var hash = $(this).attr('id');
        $.post( URL + "product/updateProductToCart", {
            hash: hash,
            op: 'remove'
        }, function( data ) {
            setProductsOfCart(config.int_location_id);
            sumTotalCart(config.int_location_id);
        }, "json");
    });

    $('#btn-send-order').on('click', function(){
        if( pdvconfig.settings.requestToken == 1 )
        {
            $('#mdRequestInfo').modal('show');
        }
        else
        {
            sendOrder('');
        }
    });

    $('#requestName').on('click', function(){
        sendOrder( $('#account').val() );
    });

    $('#btn-token-required').on('click', function(){
        if(randomtoken == 0)
        {
            swal({
                title: "",
                text: "Informe a senha da mesa, será entregue pelo garçom:",
                type: "input",
                showCancelButton: true,
                confirmButtonClass: "btn-success",
                confirmButtonText: "Confirmar",
                closeOnConfirm: false,
                closeOnCancel: true
            },
            function(inputValue) {
                var hash = 'DEQLY';
                console.log(hash);
                console.log(inputValue);
                $.post(URL + 'retail/verifyToken/' + hash + '/' + inputValue,
                    function(data) {
                        if (data.success) {
                            swal({
                                title: "",
                                text: "Mesa liberada, você já pode fazer seus pedidos",
                                type: "success"
                            });
                            terms = 1;
                            $(".cart-desc-btn").css('display','none');
                            // document.querySelector(".cart-desc-btn").style.display = "none";
                        } else {
                            swal({
                                title: "",
                                text: 'Desculpe, não foi possível liberar sua mesa. Token inválido!',
                                type: "error"
                            });
                        }
                    }, 'json');
            });
        }
        else
        {
            $.post(URL+'tds/createTable/', {
                pluginspace_id: config.pluginspace_id,
                tablenumber: ''
            }, function(data){
                console.log(data);
                if( data.success == false ) {
                    swal({
                        title: "",
                        text: 'Desculpe, ocorreu um erro ao solicitar a abertura desta mesa',
                        type: "error"
                    });
                } else {
                    // if( data.tablestatus == 'opened' ) {
                    //     swal({
                    //         title: "",
                    //         text: 'Desculpe, esta mesa já está sendo utilizada.',
                    //         type: "error"
                    //     });
                    // } else {
                        swal({
                            title: "",
                            text: "Informe a senha da mesa, será entregue pelo garçon::",
                            type: "input",
                            showCancelButton: true,
                            confirmButtonClass: "btn-success",
                            confirmButtonText: "Confirmar",
                            closeOnConfirm: false,
                            closeOnCancel: true
                        },
                        function(inputValue) {
                            $.post(URL+'tds/openTable/', {
                                pluginspace_id: config.pluginspace_id,
                                tablenumber: '',
                                token: inputValue
                            }, function (data) {
                                console.log(data);
                                if(data.success == false) {
                                    swal({
                                        title: "",
                                        text: "Desculpe, não foi possível liberar sua mesa.",
                                        type: "error"
                                    });
                                } else {
                                    swal({
                                        title: "",
                                        text: "Mesa liberada, você já pode fazer seus pedidos",
                                        type: "success"
                                    });

                                    terms = 1;
                                    $(".cart-desc-btn").css('display','none');
                                    // document.querySelector(".cart-desc-btn").style.display = "none";
                                }

                            },"json");

                        });
                    // }
                }
            },"json");
        }
    });
});

/**
 * calcula o valor que deve ser adicionado ao valor
 * do produto
 */
function calcValueAdditionals( optional, product_price, amount = 1 ){

    let total = 0;
    for( var i in optional )
    {
        let item = optional[i];
        total += item.value * item.quantity;
    }

    result = (total + product_price) * amount;
    return result.toLocaleString('pt-BR', { minimumFractionDigits: 2});
}

function sendOrder( info )
{
    window.location = URL + 'retail/pdv/DEQLY/' + config.int_location_id;
}

function replaceString(label){
    if(label != 0)
        return label.replace(",",".");
}

function setProductsOfCart(internal_id)
{
    $.post(URL+'product/listProductOfCart', {
        internal_id: internal_id
    },function(data){
        data = JSON.parse(data);
        $('#box-menu-cart').html(data.html);
    });
    $('#count-cart').load(URL+'product/countTotalCart');
}

function sumTotalCart(internal_id)
{
    // console.log(internal_id);
    $.post(URL+'product/getValueTotalCart_v2',{
        internal_id: internal_id
    }, function(data){
        // $('#total-cart').html(JSON.parse(data).value);
        $('#total-cart').html(data);
    });
}

function setLinkSelected(target)
{
    $('.link-subcategory').css('color','#999');
    $('.link-subcategory').css('border-bottom', '2px solid #999');
    // $('.link-subcategory').css('font-size','12px');
    $('.link-subcategory-img').css('background', '#ccc');
    // ----------------------------------------------------------
    var target2 = target.find('[class="link-subcategory-img"]');
    // ----------------------------------------------------------
    // target2.css('border-button', '2px solid #710008');
    target.css('border-bottom', '2px solid #4B4D50');
    target.css('color','#4B4D50');
    // target.css('font-size','13px');
    target.css('font-decoration','underline');
}

function setLoading( target )
{
    html_loading = '<div class="" style="text-align:center">';
    html_loading += '<img src="'+URL+'/public/default/loader-default.gif" width="130px" alt="">';
    html_loading += '</div>  ';

    $(target).html(html_loading);
}

function listProducts( subcategory_id, product_name = '' )
{
    /**
     * se receber um nome de produto, coloca como prioridade na busca
     * e zera a variavel subcategory_id
     */
    if( product_name != '' ){
        subcategory_id = '';
    }

    setLoading('#menu-products');
    $.post( URL + "product/listProducts/" + typetext, {
        config: config,
        subcategory_id: subcategory_id,
        webapp_id: 396,
        product_name: product_name
    }, function(data){
        // console.log(data);
        var html = '';

        for( var i in data )
        {
            var product = data[i];
            html += '<div class="col-md-6 col-xl-4">';
            html += '<div class="box-product link-product" ';
            html += 'data-price="'+product.price+'" ';
            html += 'id="'+ product.id +'" ';
            html += 'data-fractionated="'+product.fractionated+'">';
            html += '<div class="product-description">';
            if( pdvconfig.layout.useImage )
            {
                html += '<div class="p-desc">';
                    html += '<p class="product-title">'+product.name+'</p>';
                    html += '<p style="text-align:left">' + product.description.substr(0, 70) + '...</p>';

                    html += '<h5 class="price" style="text-align:left">';
                    if( product.fractionated != null )
                    {
                        if( product.fractionated == 'proportional' )
                        {
                            html += 'A partir de ';
                        }
                    }
                    html += $coin +' '+ product.price +'</h5>';
                html += '</div>'; // p-desc
                html += '<div class="p-img">';
                html += '<img class="card-img-top pb-card-img-top w-full overlay-figure overlay-scale" src="'+ product.img +'">';
                html += '</div>'; // p-img
            }
            else
            {
                html += '<div class="p-desc-noimage">';
                html += '<h5 class="product-title">'+product.name+'</h5>';
                html += '<p style="text-align:left">' + product.description.substr(0, 185) + '</p>';
                html += '<h5 class="price" style="text-align:left">'+$coin+' '+ product.price +'</h5>';
                html += '</div>'; // p-desc-noimage
            }
            html += '</div>'; // product-description
            html += '</div>';
            html += '</div>';
        }
        $('#menu-products').html(html);
    }, 'json');
}
</script>
<script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/bootstrap-sweetalert/sweetalert.js"></script>
</div><!-- page -->
</body>

<!-- Core  -->
<script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/bootstrap/bootstrap.js"></script>
<script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/babel-external-helpers/babel-external-helpers.js"></script>
<script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/vendor/bootstrap/bootstrap.js"></script>
<!-- Scripts -->
<script src="https://totvsfood.ninegrid.com.br/public/theme/material/global/js/State.js"></script>

<script>
    function enviarMessageSms(orderNum) {
        $.post(URL + 'retail/sendMessage', {
            phone: $('#customer_phone').val(),
            orderNum: orderNum,
            pluginspace_id: config_init.pluginspace_id,
            hash: config_init.webapp_hash
        }, (data) => {

        });
    }
</script>

</html>
